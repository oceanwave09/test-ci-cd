CREATE TABLE IF NOT EXISTS cynchealth_staging.medical_claim (    
    row_id VARCHAR,
    claim_type VARCHAR,
    claim_id VARCHAR,
    previous_claim_id VARCHAR,
    claim_disposition VARCHAR,
    member_id VARCHAR,
    member_mbi VARCHAR,
    member_medicaid_id VARCHAR,
    alternate_member_id VARCHAR,
    subscriber_id VARCHAR,
    member_id_suffix VARCHAR,
    member_ssn VARCHAR,
    member_mrn VARCHAR,
    member_internal_id VARCHAR,
    member_last_name VARCHAR,
    member_first_name VARCHAR,
    member_middle_initial VARCHAR,
    member_dob VARCHAR,
    member_gender VARCHAR,
    member_relationship_code VARCHAR,
    member_address_line_1 VARCHAR,
    member_address_line_2 VARCHAR,
    member_city VARCHAR,
    member_state VARCHAR,
    member_zip VARCHAR,
    insurance_company_name VARCHAR,
    insurance_company_id VARCHAR,
    insurance_group_name VARCHAR,
    insurance_group_id VARCHAR,
    insurance_group_plan_name VARCHAR,
    insurance_group_plan_id VARCHAR,
    primary_payer_code VARCHAR,
    claim_type_of_bill VARCHAR,
    claim_billed_date VARCHAR,
    claim_start_date VARCHAR,
    claim_end_date VARCHAR,
    admission_date VARCHAR,
    admission_type VARCHAR,
    admission_source VARCHAR,
    discharge_date VARCHAR,
    discharge_status VARCHAR,
    admitting_diagnosis VARCHAR,
    primary_diagnosis VARCHAR,
    diagnosis_code_1 VARCHAR,
    diagnosis_code_2 VARCHAR,
    diagnosis_code_3 VARCHAR,
    diagnosis_code_4 VARCHAR,
    principal_procedure_code VARCHAR,
    principal_procedure_desc VARCHAR,
    icd_version VARCHAR,
    drg_code VARCHAR,
    drg_type VARCHAR,
    claim_total_charges VARCHAR,
    claim_adjudication_status VARCHAR,
    claim_total_paid VARCHAR,
    claim_paid_date VARCHAR,
    network_paid_ind VARCHAR,
    claim_deduct_amount VARCHAR,
    claim_copay_amount VARCHAR,
    claim_coinsurance_amount VARCHAR,
    claim_allowed_amount VARCHAR,
    claim_discount_amount VARCHAR,
    claim_patient_paid_amount VARCHAR,
    claim_other_payer_paid VARCHAR,
    line_number VARCHAR,
    line_item_control_number VARCHAR,
    service_line_disposition VARCHAR,
    emergency_indicator VARCHAR,
    service_start_date VARCHAR,
    service_end_date VARCHAR,
    revenue_code VARCHAR,
    cpt_code VARCHAR,
    cpt_code_desc VARCHAR,
    hcpcs_code VARCHAR,
    hcpcs_code_desc VARCHAR,
    service_modifier_1 VARCHAR,
    service_modifier_2 VARCHAR,
    service_modifier_3 VARCHAR,
    service_modifier_4 VARCHAR,
    service_units VARCHAR,
    place_of_service VARCHAR,
    type_of_service VARCHAR,
    service_line_charges VARCHAR,
    line_adjudication_status VARCHAR,
    line_amount_paid VARCHAR,
    service_line_paid_date VARCHAR,
    line_payment_level VARCHAR,
    line_deduct_amount VARCHAR,
    line_copay_amount VARCHAR,
    line_coinsurance_amount VARCHAR,
    line_allowed_amount VARCHAR,
    line_discount_amount VARCHAR,
    line_patient_paid_amount VARCHAR,
    line_other_payer_paid VARCHAR,
    medicare_paid_amount VARCHAR,
    line_allowed_units VARCHAR,
    mco_paid_amount VARCHAR,
    void_sort VARCHAR,
    claim_source_id VARCHAR,
    sort_card VARCHAR,
    attending_npi VARCHAR,
    attending_internal_id VARCHAR,
    attending_last_name VARCHAR,
    attending_first_name VARCHAR,
    referring_npi VARCHAR,
    referring_internal_id VARCHAR,
    referring_last_name VARCHAR,
    referring_first_name VARCHAR,
    rendering_facility_npi VARCHAR,
    rendering_facility_internal_id VARCHAR,
    rendering_facility_name VARCHAR,
    provider_org_napb_id VARCHAR,
    line_rendering_participation VARCHAR,
    render_prescriber_npi VARCHAR,
    render_prescriber_internal_id VARCHAR,
    render_prescriber_first_name VARCHAR,
    render_prescriber_last_name VARCHAR,
    claim_paid_status VARCHAR,
    file_batch_id VARCHAR,
    file_name VARCHAR,
    file_source_name VARCHAR,
    file_status VARCHAR,
    created_user VARCHAR, 
    created_ts TIMESTAMP(3) WITH TIME ZONE,
    updated_user VARCHAR,
    updated_ts TIMESTAMP(3) WITH TIME ZONE
)
WITH (
    LOCATION = 's3a://phm-development-datapipeline-bucket/delta-tables/cynchealth/staging/medical_claim',
    PARTITIONED_BY = ARRAY['file_batch_id'],
    CHECKPOINT_INTERVAL = 5
);